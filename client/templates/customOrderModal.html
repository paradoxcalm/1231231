<div class="request-modal">
  <header class="modal-header-with-close">
    <h2 class="request-modal__title">Оформление заявки</h2>
    <button type="button" class="modal-close-btn" data-close-modal aria-label="Закрыть форму">&times;</button>
  </header>
  <section class="modal-body request-modal__body">
    <div class="section-container modal-section request-modal__content">
      <form id="dataForm" enctype="multipart/form-data">
        <h3 class="section-subtitle">ПРИЁМКА</h3>

        <input type="hidden" name="schedule_id" id="formScheduleId" value="">
        <input type="hidden" name="accept_date" id="acceptDateField" value="">
        <input type="hidden" name="delivery_date" id="deliveryDateField" value="">
        <input type="hidden" name="date_of_delivery" id="deliveryDateAlias" value="">
        <input type="hidden" name="accept_time" id="acceptTimeField" value="">
        <input type="hidden" name="direction" id="directionField" value="">

        <div class="request-modal__summary">
          <div class="modal-row request-modal__summary-row">
            <span class="modal-label">Направление:</span>
            <span class="modal-value" id="legacyDirection">—</span>
          </div>

          <div class="modal-row request-modal__summary-row">
            <span class="modal-label">Выезд → Сдача:</span>
            <span class="modal-value" id="legacyDates">—</span>
          </div>
        </div>

        <input type="hidden" id="city" name="city" value="">
        <input type="hidden" id="warehouses" name="warehouses" value="">
        <input type="hidden" id="driver_name" name="driver_name" value="">
        <input type="hidden" id="driver_phone" name="driver_phone" value="">
        <input type="hidden" id="car_number" name="car_number" value="">
        <input type="hidden" id="car_brand" name="car_brand" value="">
        <input type="hidden" id="sender" name="sender" value="">

        <div class="form-group request-form__group">
          <label class="section-label">Тип упаковки:</label>
          <div class="request-modal__option-group request-form__radio-row">
            <label class="request-modal__option request-form__option">
              <input type="radio" class="form-radio" name="packaging_type" value="Box" checked>
              <span class="request-form__option-label">Коробка</span>
            </label>
            <label class="request-modal__option request-form__option">
              <input type="radio" class="form-radio" name="packaging_type" value="Pallet">
              <span class="request-form__option-label">Паллета</span>
            </label>
          </div>
        </div>

        <div class="form-group request-form__group">
          <label for="boxes">Количество:</label>
          <input type="number" id="boxes" name="boxes" min="1" required>
        </div>

        <div id="palletInputBlock" class="form-group request-form__group request-modal__custom-box request-form__pallet-group request-form__hidden">
          <label>Параметры палет:</label>
          <div id="palletFields" class="request-modal__pallet-fields request-form__pallet-grid"></div>
          <p id="palletWarning" class="request-modal__warning request-form__warning form-error text-danger request-form__hidden">Максимум 20 палет</p>
        </div>

        <div class="form-group request-form__group" id="boxTypeBlock">
          <label class="section-label">Тип коробки:</label>
          <div class="request-modal__option-group request-form__radio-row">
            <label class="request-modal__option request-form__option">
              <input type="radio" class="form-radio" name="box_type" value="standard" checked>
              <span class="request-form__option-label">Стандарт (60×40×40)</span>
            </label>
            <label class="request-modal__option request-form__option">
              <input type="radio" class="form-radio" name="box_type" value="custom">
              <span class="request-form__option-label">Свои размеры</span>
            </label>
          </div>
        </div>

        <div class="form-group request-form__group request-form__box-dimensions" id="boxSizeBlock">
          <label>Габариты одной коробки (см):</label>
          <div class="request-modal__dimensions request-form__dimensions">
            <input type="number" id="box_length" name="box_length" placeholder="Длина" class="request-modal__dimension-input request-form__dimension-input">
            <input type="number" id="box_width" name="box_width" placeholder="Ширина" class="request-modal__dimension-input request-form__dimension-input">
            <input type="number" id="box_height" name="box_height" placeholder="Высота" class="request-modal__dimension-input request-form__dimension-input">
          </div>
        </div>

        <div class="form-group request-form__group request-modal__custom-box request-form__custom-box request-form__hidden" id="customBoxFieldsBlock">
          <label>Свои группы коробов:</label>
          <input type="number" id="customBoxGroupCount" min="1" max="10" placeholder="Кол-во групп" class="request-modal__group-count request-form__group-count">
          <div id="customBoxFields" class="request-modal__custom-fields request-form__custom-fields"></div>
          <p id="customBoxWarning" class="request-modal__warning request-form__warning form-error text-danger request-form__hidden">Сумма количеств в группах не должна превышать общее количество коробов</p>
        </div>

        <div class="form-group request-form__group request-form__summary"><label>Общий объём:</label><span id="box_volume" class="request-form__summary-value">—</span></div>
        <div class="form-group request-form__group request-form__summary"><label>Тариф:</label><span id="tariff_rate" class="request-form__summary-value">—</span></div>
        <div class="form-group request-form__group"><label for="payment">Сумма оплаты:</label>
          <input type="number" id="payment" name="payment" readonly>
        </div>

        <div class="form-group request-form__group request-form__checkbox">
          <label class="form-switch request-form__switch">
            <input type="checkbox" id="pickupCheckbox" name="pickup_checkbox" class="form-switch__input">
            <span class="form-switch__control" aria-hidden="true"></span>
            <span class="form-switch__label">Забрать груз с адреса отправителя</span>
          </label>
        </div>

        <div id="pickupAddressFields" class="request-modal__pickup request-form__pickup request-form__hidden">
          <div class="request-card">
            <div class="request-card__body">
              <div id="pickupMap" class="request-card__map request-modal__map request-form__map"></div>

              <input type="hidden" id="pickupLat" name="pickup_lat">
              <input type="hidden" id="pickupLng" name="pickup_lng">

              <div class="request-card__field">
                <label for="clientPhone" class="request-card__label request-modal__pickup-label request-form__pickup-label">Номер для связи:</label>
                <input type="tel" id="clientPhone" name="client_phone" placeholder="+7 (999) 123-45-67" class="request-card__input request-modal__pickup-phone request-form__pickup-input">
              </div>

              <div id="routeBlock" class="request-card__route request-modal__route request-form__route request-form__hidden">
                <span class="request-card__route-label request-modal__route-label request-form__route-label">Ссылка для навигатора:</span>
                <div class="request-card__routes request-modal__route-links request-form__route-links">
                  <div class="request-card__route-group">
                    <a id="routeLinkYandex" href="#" target="_blank" class="link-button request-card__link request-modal__route-link request-form__route-link"></a>
                    <button type="button" id="routeCopyBtn" class="ghost-button request-card__copy request-modal__route-copy request-form__route-copy">Копировать</button>
                  </div>
                  <a id="routeLinkGoogle" href="#" target="_blank" class="link-button request-card__link request-modal__route-link request-form__route-link"></a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="form-group request-form__group">
          <label for="comment">Комментарий:</label>
          <textarea id="comment" name="comment" rows="3" placeholder="Введите комментарий"></textarea>
        </div>
        <div class="modal-actions request-form__actions">
          <button type="submit" class="primary-button request-form__submit">
            <span class="button__label">Отправить</span>
          </button>
        </div>
      </form>
      <p id="status" class="request-form__status"></p>
    </div>
  </section>
</div>
